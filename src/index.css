@import "tailwindcss";

@theme {
    /* Brand Colors */
    --color-brand-dark: #10100eff;
    --color-brand-darkSurface: #10100eff;
    --color-brand-light: #E5E5E5;
    --color-brand-lightSurface: #FFFFFF;
    --color-brand-accent: #3B82F6;      /* Dynamic: Set by ThemeContext */

    /* Role Default Colors */
    --color-student-accent: #10B981;    /* Emerald-500 */
    --color-teacher-accent: #3B82F6;    /* Blue-500 */

    /* Text Colors */
    --color-brand-textPrimary: #F2EFEA;
    /* Light text on dark */
    --color-brand-textSecondary: #A8A29D;
    --color-brand-textDarkPrimary: #141211;
    /* Dark text on light */
    --color-brand-textDarkSecondary: #57534E;

    /* Status Colors */
    --color-status-progress: #059669;
    /* Emerald */
    --color-status-stuck: #DC2626;
    /* Red */
    --color-status-question: #D97706;
    /* Amber */
    --color-status-complete: #2563EB;
    /* Blue */
}

/* ============================================
   CSS Custom Properties (Design Tokens)
   ============================================ */
:root {
    /* Spacing Scale */
    --spacing-xs: 0.25rem;
    --spacing-sm: 0.5rem;
    --spacing-md: 1rem;
    --spacing-lg: 1.5rem;
    --spacing-xl: 2rem;
    
    /* Border Radius */
    --radius-sm: 0.5rem;
    --radius-md: 0.75rem;
    --radius-lg: 1rem;
    --radius-xl: 1.5rem;
    
    /* Border Width */
    --border-width: 3px;
    
    /* Transitions */
    --transition-fast: 150ms;
    --transition-normal: 200ms;
    --transition-slow: 300ms;
    
    /* Touch Target Minimum (44px for accessibility) */
    --touch-target-min: 44px;
}

/* ============================================
   Global Styles
   ============================================ */
* {
    /* Hide scrollbar for Chrome, Safari and Opera */
    &::-webkit-scrollbar {
        display: none;
    }

    /* Hide scrollbar for IE, Edge and Firefox */
    -ms-overflow-style: none;
    /* IE and Edge */
    scrollbar-width: none;
    /* Firefox */
}

body {
    @apply bg-[#141211] text-[#F2EFEA] antialiased;
}

/* ============================================
   Form Styling - accent-color & caret-color
   ============================================ */
input[type="date"],
input[type="checkbox"],
input[type="radio"],
input[type="range"] {
    accent-color: var(--color-brand-accent);
}

input,
textarea {
    caret-color: var(--color-brand-accent);
}

/* Date picker indicator styling */
input[type="date"]::-webkit-calendar-picker-indicator {
    filter: invert(0.5);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    transition: all var(--transition-fast) ease;
}

input[type="date"]::-webkit-calendar-picker-indicator:hover {
    filter: invert(0.7);
    background-color: rgba(59, 130, 246, 0.1);
}

.dark input[type="date"]::-webkit-calendar-picker-indicator {
    filter: invert(0.8);
}

.dark input[type="date"]::-webkit-calendar-picker-indicator:hover {
    filter: invert(1);
}

/* ============================================
   Focus-Visible Accessibility
   ============================================ */
*:focus-visible {
    outline: 2px solid var(--color-brand-accent);
    outline-offset: 2px;
    border-radius: var(--radius-sm);
}

/* Remove default outline when using mouse */
*:focus:not(:focus-visible) {
    outline: none;
}

/* ============================================
   Overflow Fixes (auto instead of scroll)
   ============================================ */
.custom-scrollbar {
    overflow-y: auto; /* Changed from scroll to auto */
}

@layer components {

    /* ============================================
       Reusable Input Classes
       ============================================ */
    .input-field {
        @apply w-full px-3 py-2 rounded-xl border-[3px] transition-all duration-200;
        @apply bg-transparent font-medium;
        @apply text-brand-textDarkPrimary dark:text-brand-textPrimary;
        @apply border-gray-200 dark:border-gray-700;
        @apply placeholder-gray-400 dark:placeholder-gray-500;
        @apply hover:border-gray-400 dark:hover:border-gray-100;
        @apply focus:outline-none focus:border-gray-300 dark:focus:border-gray-100;
    }
    
    .input-field-sm {
        @apply input-field text-sm;
    }

    /* ============================================
       Card Interactive States
       ============================================ */
    .card-interactive {
        @apply rounded-xl border-[3px] transition-all cursor-pointer;
        @apply border-gray-200 dark:border-gray-700;
        @apply hover:border-gray-300 dark:hover:border-gray-600;
        @apply bg-brand-lightSurface dark:bg-brand-darkSurface;
    }
    
    .card-interactive-selected {
        @apply border-brand-accent bg-brand-accent/5;
    }

    /* ============================================
       Button Ghost/Outline Variants
       ============================================ */
    .btn-ghost {
        @apply flex items-center justify-center gap-2 h-12 px-4 rounded-xl;
        @apply font-bold transition-all duration-200;
        @apply border-[3px] border-transparent;
        @apply hover:border-brand-accent text-brand-accent hover:bg-brand-accent/5;
        @apply focus:outline-none focus:ring-2 focus:ring-brand-accent/20;
        @apply disabled:opacity-50 disabled:cursor-not-allowed;
    }
    
    .btn-ghost-danger {
        @apply btn-ghost text-red-500;
        @apply hover:border-red-500 hover:bg-red-500/5;
        @apply focus:ring-red-500/20;
    }

    /* ============================================
       Touch Target Minimum Size
       ============================================ */
    .touch-target {
        min-width: var(--touch-target-min);
        min-height: var(--touch-target-min);
        @apply flex items-center justify-center;
    }

    /* ============================================
       Active/Pressed State for Touch
       ============================================ */
    .btn-tactile:active {
        transform: scale(0.98);
        transition: transform 0.1s ease-out;
    }

    /* ============================================
       Success Animation
       ============================================ */
    @keyframes success-bounce {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }
    
    .animate-success {
        animation: success-bounce 0.3s ease-out;
    }

    /* ============================================
       Skeleton Loading Placeholder
       ============================================ */
    .skeleton {
        @apply bg-gray-200 dark:bg-gray-700 rounded animate-pulse;
    }
    
    .skeleton-text {
        @apply skeleton h-4 w-full;
    }
    
    .skeleton-text-sm {
        @apply skeleton h-3 w-3/4;
    }
    
    .skeleton-card {
        @apply skeleton h-20 w-full rounded-xl;
    }

    /* ============================================
       Accordion Animation (grid-template-rows)
       ============================================ */
    .accordion-content {
        display: grid;
        grid-template-rows: 0fr;
        transition: grid-template-rows var(--transition-slow) ease-out;
        overflow: hidden;
    }
    
    .accordion-content.open {
        grid-template-rows: 1fr;
    }
    
    .accordion-inner {
        min-height: 0;
    }

    /* Skip link - Accessibility: hidden until focused */
    .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        padding: 8px 16px;
        background: var(--color-brand-accent);
        color: white;
        z-index: 9999;
        transition: top 0.2s ease;
        font-weight: 600;
        text-decoration: none;
        border-radius: 0 0 8px 0;
    }

    .skip-link:focus {
        top: 0;
        outline: 2px solid white;
        outline-offset: 2px;
    }

    /* Dynamic viewport height utility for mobile browser compatibility */
    .h-screen-safe {
        height: 100vh;
        /* Fallback */
        height: 100dvh;
    }

    /* Safe area insets for notched devices (iPhone X+, etc.) */
    .safe-area-pb {
        padding-bottom: env(safe-area-inset-bottom, 0);
    }

    .safe-area-pt {
        padding-top: env(safe-area-inset-top, 0);
    }

    .safe-area-inset {
        padding-top: env(safe-area-inset-top, 0);
        padding-right: env(safe-area-inset-right, 0);
        padding-bottom: env(safe-area-inset-bottom, 0);
        padding-left: env(safe-area-inset-left, 0);
    }

    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }

    .input-base {
        @apply w-full px-4 py-2.5 rounded-xl border-[3px] transition-all duration-200;
        @apply bg-transparent;
        @apply text-brand-textDarkPrimary dark:text-brand-textPrimary;
        @apply border-gray-200 dark:border-gray-700;
        @apply placeholder-gray-400 dark:placeholder-gray-500 font-medium;
        @apply hover:border-brand-accent/60;

        /* Override browser autofill background */
        &:-webkit-autofill,
        &:-webkit-autofill:hover,
        &:-webkit-autofill:focus,
        &:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 30px #10100e inset !important;
            -webkit-text-fill-color: #F2EFEA !important;
            caret-color: #F2EFEA !important;
        }
    }

    .input-focus {
        @apply focus:outline-none focus:border-brand-accent;
        @apply focus:ring-2 focus:ring-brand-accent/20;
    }

    .btn-primary-green {
        @apply w-full py-2.5 px-4 rounded-xl border-[3px] transition-all duration-200;
        @apply bg-transparent;
        @apply text-brand-accent font-bold;
        @apply border-brand-accent;
        @apply hover:bg-brand-accent/10;
        @apply focus:outline-none focus:ring-2 focus:ring-brand-accent/30;
        @apply disabled:opacity-50 disabled:cursor-not-allowed;
    }

    .card-base {
        @apply bg-brand-lightSurface dark:bg-brand-darkSurface;
        @apply border-[3px] border-gray-200 dark:border-gray-700;
        @apply rounded-xl transition-colors;
    }

    /* Responsive padding using min() - shrinks on mobile, caps on desktop */
    .p-responsive {
        padding: min(5vw, 24px);
    }

    .px-responsive {
        padding-left: min(5vw, 24px);
        padding-right: min(5vw, 24px);
    }

    .py-responsive {
        padding-top: min(4vw, 20px);
        padding-bottom: min(4vw, 20px);
    }

    /* Fluid typography using clamp() - smooth scaling between breakpoints
       Pattern: clamp(min, calc(vw + rem), max)
       - rem base ensures user zoom works (accessibility)
       - vw creates responsive scaling
       - clamp() prevents extremes on very small/large screens */
    .text-fluid-xs {
        font-size: clamp(0.75rem, calc(1vw + 0.5rem), 0.875rem);
    }

    .text-fluid-sm {
        font-size: clamp(0.875rem, calc(1.5vw + 0.5rem), 1rem);
    }

    .text-fluid-base {
        font-size: clamp(1rem, calc(2vw + 0.5rem), 1.25rem);
    }

    .text-fluid-lg {
        font-size: clamp(1.125rem, calc(2.5vw + 0.5rem), 1.5rem);
    }

    .text-fluid-xl {
        font-size: clamp(1.25rem, calc(3vw + 0.5rem), 1.75rem);
    }

    .text-fluid-2xl {
        font-size: clamp(1.5rem, calc(4vw + 0.5rem), 2.5rem);
    }

    .text-fluid-3xl {
        font-size: clamp(1.875rem, calc(5vw + 0.5rem), 3rem);
    }

    /* Responsive images with aspect-ratio */
    .img-responsive {
        width: 100%;
        height: auto;
        object-fit: cover;
    }

    .img-square {
        aspect-ratio: 1 / 1;
        object-fit: cover;
    }

    .img-video {
        aspect-ratio: 16 / 9;
        object-fit: cover;
    }

    .img-portrait {
        aspect-ratio: 3 / 4;
        object-fit: cover;
    }

    /* Header fade - gradient fade over bottom 16px (72-88px) */
    .header-fade {
        background: var(--color-brand-lightSurface);
        -webkit-mask-image: linear-gradient(to bottom, black calc(100% - 16px), transparent 100%);
        mask-image: linear-gradient(to bottom, black calc(100% - 16px), transparent 100%);
    }

    .dark .header-fade {
        background: var(--color-brand-darkSurface);
    }

    /* Footer fade - masks entire element, fading top 12px */
    .footer-fade {
        background: var(--color-brand-lightSurface);
        -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 12px);
        mask-image: linear-gradient(to bottom, transparent 0%, black 12px);
    }

    .dark .footer-fade {
        background: var(--color-brand-darkSurface);
    }
}